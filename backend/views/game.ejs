<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="/css/menu.css" />
	<link rel="stylesheet" href="/css/game.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
		integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
		crossorigin="anonymous" referrerpolicy="no-referrer" />
	<title>Wait Room</title>
</head>

<body>
	<%- include('partials/menu') %>

		<h1>Bingo Game</h1>
		<div id="boss"></div>
		<div id="timer"></div>
		<% if (gameInfo.drawn_number && gameInfo.drawn_number.length > 0) { %>
			<div id="called-numbers"><%= gameInfo.drawn_number + ', ' %></div>
		<% } else { %>
			<div id="called-numbers"></div>
		<% } %>
		<div id="players">
			<section>
				<% for (let player of gameInfo.players) { %>
					<% if (session.user.userId===player.user_id) { %>
						<button class="startButton" id="bingoButton"
							onclick="checkWon('<%= player.user_id %>','<%= gameInfo.room_id %>')">Bingo</button>
						<div class="bingo-card" id="player<%= player.user_id %>">
							<h2>Player <%= player.username %>
							</h2>
							<% for (let row=0; row < player.card_data.length; row++) { %>
								<div class="bingo-row">
									<% for (let col=0; col < player.card_data[row].length; col++) { %>
										<div class="bingo-cell"
											id="<%= player.user_id + '-' + row + '-' + col + '-' + player.card_data[row][col] %>"
											onclick="markNumber(this)">
											<%= player.card_data[row][col]===0 ? "Free" : player.card_data[row][col] %>
										</div>
										<% } %>
								</div>
								<% } %>
						</div>


						<% } else { %>
							<div class="bingo-card" id="player<%= player.user_id %>">
								<h2>Player <%= player.username %>
								</h2>
								<% for (let row=0; row < player.card_data.length; row++) { %>
									<div class="bingo-row">
										<% for (let col=0; col < player.card_data[row].length; col++) { %>
											<div class="bingo-cell"
												id="<%= player.user_id + '-' + row + '-' + col + '-' + player.card_data[row][col] %>">
											</div>
											<% } %>
									</div>
									<% } %>
							</div>
							<% } %>
								<% } %>
			</section>
		</div>

		<%- include('partials/chat', { session: session, roomId: gameInfo.room_id }) %>
			<script hidden>
				const userId = '<%= session.user.userId%>'
				const hostId = '<%= gameInfo.host_id %>'
				const userName = '<%= session.user.username %>'
				const startTime = '<%= gameInfo.start_time %>'; // Adjust format as needed
			</script>

			<script src="/script/game.js"></script>
</body>

</html>